<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/stylesheets/style.css" />
    <title><%= recipe.name %> - Recipe Details</title>
</head>
<body>
    <%- include('../partials/_navbar.ejs') %>
    
    <h1><%= recipe.name %></h1>
    <p>Created by: <%= recipe.owner.username %></p>
    
    <h2>Ingredients:</h2>
    <% if (recipe.ingredients && recipe.ingredients.length > 0) { %>
        <ul>
            <% recipe.ingredients.forEach(ingredient => { %>
                <li>
                    <% if (typeof ingredient === 'object' && ingredient.name) { %>
                        <%= ingredient.name %>
                    <% } else { %>
                        <%= ingredient %>
                    <% } %>
                </li>
            <% }) %>
        </ul>
    <% } else { %>
        <p>No ingredients listed.</p>
    <% } %>
    
    <h2>Instructions:</h2>
    <p><%= recipe.instructions %></p>
    
    <a href="/recipes">Back to Recipes</a>
    
    <% if (user && recipe.owner._id.toString() === user._id.toString()) { %>
        <a href="/recipes/<%= recipe._id %>/edit">Edit Recipe</a>
        <form action="/recipes/<%= recipe._id %>?_method=DELETE" method="POST" style="display: inline;">
            <button type="submit" onclick="return confirm('Are you sure you want to delete this recipe?')">Delete Recipe</button>
        </form>
    <% } %>
</body>
</html>